<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hidden Markov Models · StateSpaceDynamics.jl</title><meta name="title" content="Hidden Markov Models · StateSpaceDynamics.jl"/><meta property="og:title" content="Hidden Markov Models · StateSpaceDynamics.jl"/><meta property="twitter:title" content="Hidden Markov Models · StateSpaceDynamics.jl"/><meta name="description" content="Documentation for StateSpaceDynamics.jl."/><meta property="og:description" content="Documentation for StateSpaceDynamics.jl."/><meta property="twitter:description" content="Documentation for StateSpaceDynamics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="StateSpaceDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">StateSpaceDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../LinearDynamicalSystems/">Linear Dynamical Systems</a></li><li class="is-active"><a class="tocitem" href>Hidden Markov Models</a></li><li><a class="tocitem" href="../EmissionModels/">EmissionModels</a></li><li><a class="tocitem" href="../MixtureModels/">Mixture Models</a></li></ul></li><li><a class="tocitem" href="../Misc/">Miscellaneous</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Hidden Markov Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hidden Markov Models</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hidden-Markov-Models"><a class="docs-heading-anchor" href="#Hidden-Markov-Models">Hidden Markov Models</a><a id="Hidden-Markov-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Hidden-Markov-Models" title="Permalink"></a></h1><p>A Hidden Markov Model (HMM) is a time series model with unobservable latent variables that follow a Markov process. Condititional distributions (when conditioned on the latents) are often chosen to be common distributions (e.g. Gaussian).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.HiddenMarkovModel" href="#StateSpaceDynamics.HiddenMarkovModel"><code>StateSpaceDynamics.HiddenMarkovModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HiddenMarkovModel</code></pre><p>A Hidden Markov Model (HMM) with custom emissions.</p><p><strong>Fields</strong></p><ul><li><code>K::Int</code>: Number of states.</li><li><code>B::Vector=Vector()</code>: Vector of emission models.</li><li><code>emission=nothing</code>: If B is missing emissions, clones of this model will be used to fill in the rest.</li><li><code>A::Matrix{&lt;:Real}</code>: Transition matrix.</li><li><code>πₖ::Vector{Float64}</code>: Initial state distribution.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.class_probabilities" href="#StateSpaceDynamics.class_probabilities"><code>StateSpaceDynamics.class_probabilities</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function class_probabilities(model::HiddenMarkovModel, Y::Matrix{&lt;:Real}, X::Union{Matrix{&lt;:Real},Nothing}=nothing;)</code></pre><p>Calculate the class probabilities at each time point using forward backward algorithm</p><p><strong>Arguments</strong></p><ul><li><code>model::HiddenMarkovModel</code>: The Hidden Markov Model to fit.</li><li><code>Y::Matrix{&lt;:Real}</code>: The emission data</li><li><code>X::Union{Matrix{&lt;:Real},Nothing}=nothing</code>: Optional input data for fitting Switching Regression Models</li></ul><p><strong>Returns</strong></p><ul><li><code>class_probabilities::Matrix{Float64}</code>: The class probabilities at each timepoint</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.class_probabilities" href="#StateSpaceDynamics.class_probabilities"><code>StateSpaceDynamics.class_probabilities</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function class_probabilities(model::HiddenMarkovModel, Y::Vector{&lt;:Matrix{&lt;:Real}}, X::Union{Vector{&lt;:Matrix{&lt;:Real}},Nothing}=nothing;)</code></pre><p>Calculate the class probabilities at each time point using forward backward algorithm on multiple trials of data</p><p><strong>Arguments</strong></p><ul><li><code>model::HiddenMarkovModel</code>: The Hidden Markov Model to fit.</li><li><code>Y::Vectpr{&lt;:Matrix{&lt;:Real}}</code>: The trials of emission data</li><li><code>X::Union{Vector{&lt;:Matrix{&lt;:Real}},Nothing}=nothing</code>: Optional trials of input data for fitting Switching Regression Models</li></ul><p><strong>Returns</strong></p><ul><li><code>class_probabilities::Vector{&lt;:Matrix{Float64}}</code>: Each trial&#39;s class probabilities at each timepoint</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.fit!" href="#StateSpaceDynamics.fit!"><code>StateSpaceDynamics.fit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit!(model::HiddenMarkovModel, Y::Matrix{&lt;:Real}, X::Union{Matrix{&lt;:Real}, Nothing}=nothing; max_iters::Int=100, tol::Float64=1e-6)</code></pre><p>Fit the Hidden Markov Model using the EM algorithm.</p><p><strong>Arguments</strong></p><ul><li><code>model::HiddenMarkovModel</code>: The Hidden Markov Model to fit.</li><li><code>Y::Matrix{&lt;:Real}</code>: The emission data.</li><li><code>X::Union{Matrix{&lt;:Real}, Nothing}=nothing</code>: Optional input data for fitting Switching Regression Models</li><li><code>max_iters::Int=100</code>: The maximum number of iterations to run the EM algorithm.</li><li><code>tol::Float64=1e-6</code>: When the log likelihood is improving by less than this value, the algorithm will stop.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.fit!" href="#StateSpaceDynamics.fit!"><code>StateSpaceDynamics.fit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit!(model::HiddenMarkovModel, Y::Matrix{&lt;:Real}, X::Union{Matrix{&lt;:Real}, Nothing}=nothing; max_iters::Int=100, tol::Float64=1e-6)</code></pre><p>Fit the Hidden Markov Model to multiple trials of data using the EM algorithm.</p><p><strong>Arguments</strong></p><ul><li><code>model::HiddenMarkovModel</code>: The Hidden Markov Model to fit.</li><li><code>Y::Vector{&lt;:Matrix{&lt;:Real}}</code>: The trialized emission data.</li><li><code>X::Union{Vector{&lt;:Matrix{&lt;:Real}}, Nothing}=nothing</code>: Optional input data for fitting Switching Regression Models</li><li><code>max_iters::Int=100</code>: The maximum number of iterations to run the EM algorithm.</li><li><code>tol::Float64=1e-6</code>: When the log likelihood is improving by less than this value, the algorithm will stop.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.sample" href="#StateSpaceDynamics.sample"><code>StateSpaceDynamics.sample</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample(model::HiddenMarkovModel, data...; n::Int)</code></pre><p>Generate <code>n</code> samples from a Hidden Markov Model. Returns a tuple of the state sequence and the observation sequence.</p><p><strong>Arguments</strong></p><ul><li><code>model::HiddenMarkovModel</code>: The Hidden Markov Model to sample from.</li><li><code>data...</code>: The data to fit the Hidden Markov Model. Requires the same format as the emission model.</li><li><code>n::Int</code>: The number of samples to generate.</li></ul><p><strong>Returns</strong></p><ul><li><code>state_sequence::Vector{Int}</code>: The state sequence, where each element is an integer 1:K.</li><li><code>observation_sequence::Matrix{Float64}</code>: The observation sequence. This takes the form of the emission model&#39;s output.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.viterbi" href="#StateSpaceDynamics.viterbi"><code>StateSpaceDynamics.viterbi</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viterbi(model::HiddenMarkovModel, Y::Matrix{&lt;:Real}, X::Union{Matrix{&lt;:Real},Nothing}=nothing;)</code></pre><p>Get most likely class labels using the Viterbi algorithm</p><p><strong>Arguments</strong></p><ul><li><code>model::HiddenMarkovModel</code>: The Hidden Markov Model to fit.</li><li><code>Y::Matrix{&lt;:Real}</code>: The emission data</li><li><code>X::Union{Matrix{&lt;:Real},Nothing}=nothing</code>: Optional input data for fitting Switching Regression Models</li></ul><p><strong>Returns</strong></p><ul><li><code>best_path::Vector{Float64}</code>: The most likely state label at each timepoint</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.viterbi" href="#StateSpaceDynamics.viterbi"><code>StateSpaceDynamics.viterbi</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viterbi(model::HiddenMarkovModel, Y::Vector{&lt;:Matrix{&lt;:Real}}, X::Union{Vector{&lt;:Matrix{&lt;:Real}},Nothing}=nothing;)</code></pre><p>Get most likely class labels using the Viterbi algorithm for multiple trials of data</p><p><strong>Arguments</strong></p><ul><li><code>model::HiddenMarkovModel</code>: The Hidden Markov Model to fit.</li><li><code>Y::Vectpr{&lt;:Matrix{&lt;:Real}}</code>: The trials of emission data</li><li><code>X::Union{Vector{&lt;:Matrix{&lt;:Real}},Nothing}=nothing</code>: Optional trials of input data for fitting Switching Regression Models</li></ul><p><strong>Returns</strong></p><ul><li><code>best_path::Vector{&lt;:Vector{Float64}}</code>: Each trial&#39;s best state path</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.GaussianHMM-Tuple{}" href="#StateSpaceDynamics.GaussianHMM-Tuple{}"><code>StateSpaceDynamics.GaussianHMM</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GaussianHMM(; K::Int, output_dim::Int, A::Matrix{&lt;:Real}=initialize_transition_matrix(K), πₖ::Vector{Float64}=initialize_state_distribution(K))</code></pre><p>Create a Hidden Markov Model with Gaussian Emissions</p><p><strong>Arguments</strong></p><ul><li><code>K::Int</code>: The number of hidden states</li><li><code>output_dim::Int</code>: The dimensionality of the observation</li><li><code>A::Matrix{&lt;:Real}=initialize_transition_matrix(K)</code>: The transition matrix of the HMM (defaults to random initialization)</li><li><code>πₖ::Vector{Float64}=initialize_state_distribution(K)</code>: The initial state distribution of the HMM (defaults to random initialization)</li></ul><p><strong>Returns</strong></p><ul><li><code>::HiddenMarkovModel</code>: Hidden Markov Model Object with Gaussian Emissions</li></ul><p>```</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.SwitchingBernoulliRegression-Tuple{}" href="#StateSpaceDynamics.SwitchingBernoulliRegression-Tuple{}"><code>StateSpaceDynamics.SwitchingBernoulliRegression</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SwitchingBernoulliRegression(; K::Int, input_dim::Int, include_intercept::Bool=true, β::Vector{&lt;:Real}=if include_intercept zeros(input_dim + 1) else zeros(input_dim) end, λ::Float64=0.0, A::Matrix{&lt;:Real}=initialize_transition_matrix(K), πₖ::Vector{Float64}=initialize_state_distribution(K))</code></pre><p>Create a Switching Bernoulli Regression Model</p><p><strong>Arguments</strong></p><ul><li><code>K::Int</code>: The number of hidden states.</li><li><code>input_dim::Int</code>: The dimensionality of the input data.</li><li><code>include_intercept::Bool=true</code>: Whether to include an intercept in the regression model (defaults to true).</li><li><code>β::Vector{&lt;:Real}</code>: The regression coefficients (defaults to zeros). </li><li><code>λ::Float64=0.0</code>: Regularization parameter for the regression (defaults to zero).</li><li><code>A::Matrix{&lt;:Real}=initialize_transition_matrix(K)</code>: The transition matrix of the HMM (defaults to random initialization).</li><li><code>πₖ::Vector{Float64}=initialize_state_distribution(K)</code>: The initial state distribution of the HMM (defaults to random initialization).</li></ul><p><strong>Returns</strong></p><ul><li><code>::HiddenMarkovModel</code>: A Switching Bernoulli Regression Model</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StateSpaceDynamics.SwitchingGaussianRegression-Tuple{}" href="#StateSpaceDynamics.SwitchingGaussianRegression-Tuple{}"><code>StateSpaceDynamics.SwitchingGaussianRegression</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SwitchingGaussianRegression(; 
    K::Int,
    input_dim::Int,
    output_dim::Int,
    include_intercept::Bool = true,
    β::Matrix{&lt;:Real} = if include_intercept
        zeros(input_dim + 1, output_dim)
    else
        zeros(input_dim, output_dim)
    end,
    Σ::Matrix{&lt;:Real} = Matrix{Float64}(I, output_dim, output_dim),
    λ::Float64 = 0.0,
    A::Matrix{&lt;:Real} = initialize_transition_matrix(K),
    πₖ::Vector{Float64} = initialize_state_distribution(K)
)</code></pre><p>Create a Switching Gaussian Regression Model</p><p><strong>Arguments</strong></p><ul><li><code>K::Int</code>: The number of hidden states.</li><li><code>input_dim::Int</code>: The dimensionality of the input features.</li><li><code>output_dim::Int</code>: The dimensionality of the output predictions.</li><li><code>include_intercept::Bool</code>: Whether to include an intercept in the regression model (default is <code>true</code>).</li><li><code>β::Matrix{&lt;:Real}</code>: The regression coefficients (defaults to zeros based on <code>input_dim</code> and <code>output_dim</code>).</li><li><code>Σ::Matrix{&lt;:Real}</code>: The covariance matrix of the Gaussian emissions (defaults to an identity matrix).</li><li><code>λ::Float64</code>: The regularization parameter for the regression (default is <code>0.0</code>).</li><li><code>A::Matrix{&lt;:Real}</code>: The transition matrix of the Hidden Markov Model (defaults to random initialization).</li><li><code>πₖ::Vector{Float64}</code>: The initial state distribution of the Hidden Markov Model (defaults to random initialization).</li></ul><p><strong>Returns</strong></p><ul><li><code>::HiddenMarkovModel</code>: A Switching Gaussian Regression Model</li></ul></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../LinearDynamicalSystems/">« Linear Dynamical Systems</a><a class="docs-footer-nextpage" href="../EmissionModels/">EmissionModels »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Wednesday 19 March 2025 14:51">Wednesday 19 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
